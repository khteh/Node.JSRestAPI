function cov_19wsuprknc(){var path="C:\\Projects\\Node.js\\Node.JSRestAPI\\BusinessLogic\\registration.js";var hash="cd48076a28925ea1513c1a2d982a58b93a859cab";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Projects\\Node.js\\Node.JSRestAPI\\BusinessLogic\\registration.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:21},end:{line:2,column:47}},"2":{start:{line:3,column:13},end:{line:3,column:29}},"3":{start:{line:4,column:9},end:{line:4,column:32}},"4":{start:{line:5,column:12},end:{line:5,column:28}},"5":{start:{line:7,column:20},end:{line:7,column:22}},"6":{start:{line:8,column:18},end:{line:8,column:54}},"7":{start:{line:9,column:4},end:{line:9,column:71}},"8":{start:{line:10,column:18},end:{line:10,column:20}},"9":{start:{line:11,column:19},end:{line:11,column:21}},"10":{start:{line:12,column:4},end:{line:17,column:35}},"11":{start:{line:13,column:8},end:{line:13,column:59}},"12":{start:{line:14,column:9},end:{line:17,column:35}},"13":{start:{line:15,column:8},end:{line:15,column:66}},"14":{start:{line:17,column:8},end:{line:17,column:35}},"15":{start:{line:18,column:4},end:{line:35,column:5}},"16":{start:{line:19,column:8},end:{line:30,column:9}},"17":{start:{line:20,column:12},end:{line:21,column:42}},"18":{start:{line:21,column:16},end:{line:21,column:42}},"19":{start:{line:22,column:12},end:{line:22,column:72}},"20":{start:{line:24,column:12},end:{line:24,column:93}},"21":{start:{line:24,column:41},end:{line:24,column:89}},"22":{start:{line:24,column:73},end:{line:24,column:89}},"23":{start:{line:25,column:12},end:{line:29,column:13}},"24":{start:{line:26,column:16},end:{line:27,column:46}},"25":{start:{line:27,column:20},end:{line:27,column:46}},"26":{start:{line:28,column:16},end:{line:28,column:94}},"27":{start:{line:32,column:8},end:{line:33,column:38}},"28":{start:{line:33,column:12},end:{line:33,column:38}},"29":{start:{line:34,column:8},end:{line:34,column:74}},"30":{start:{line:36,column:21},end:{line:50,column:5}},"31":{start:{line:37,column:24},end:{line:37,column:26}},"32":{start:{line:38,column:28},end:{line:38,column:80}},"33":{start:{line:39,column:8},end:{line:49,column:11}},"34":{start:{line:40,column:12},end:{line:46,column:55}},"35":{start:{line:41,column:16},end:{line:41,column:45}},"36":{start:{line:42,column:17},end:{line:46,column:55}},"37":{start:{line:43,column:16},end:{line:43,column:41}},"38":{start:{line:44,column:16},end:{line:44,column:62}},"39":{start:{line:46,column:16},end:{line:46,column:55}},"40":{start:{line:47,column:12},end:{line:47,column:43}},"41":{start:{line:48,column:12},end:{line:48,column:39}},"42":{start:{line:51,column:4},end:{line:201,column:5}},"43":{start:{line:52,column:2},end:{line:197,column:5}},"44":{start:{line:54,column:27},end:{line:54,column:79}},"45":{start:{line:55,column:7},end:{line:65,column:10}},"46":{start:{line:56,column:11},end:{line:63,column:52}},"47":{start:{line:57,column:15},end:{line:57,column:65}},"48":{start:{line:58,column:16},end:{line:63,column:52}},"49":{start:{line:59,column:15},end:{line:59,column:40}},"50":{start:{line:60,column:15},end:{line:60,column:56}},"51":{start:{line:63,column:15},end:{line:63,column:52}},"52":{start:{line:64,column:11},end:{line:64,column:35}},"53":{start:{line:67,column:7},end:{line:67,column:43}},"54":{start:{line:68,column:7},end:{line:85,column:32}},"55":{start:{line:69,column:11},end:{line:69,column:53}},"56":{start:{line:70,column:31},end:{line:70,column:83}},"57":{start:{line:71,column:28},end:{line:83,column:13}},"58":{start:{line:72,column:15},end:{line:81,column:16}},"59":{start:{line:73,column:19},end:{line:73,column:48}},"60":{start:{line:76,column:19},end:{line:80,column:88}},"61":{start:{line:77,column:23},end:{line:77,column:51}},"62":{start:{line:78,column:23},end:{line:78,column:97}},"63":{start:{line:80,column:23},end:{line:80,column:88}},"64":{start:{line:82,column:15},end:{line:82,column:39}},"65":{start:{line:85,column:11},end:{line:85,column:32}},"66":{start:{line:87,column:7},end:{line:87,column:64}},"67":{start:{line:88,column:7},end:{line:183,column:10}},"68":{start:{line:89,column:27},end:{line:89,column:29}},"69":{start:{line:89,column:48},end:{line:89,column:50}},"70":{start:{line:90,column:11},end:{line:90,column:57}},"71":{start:{line:91,column:11},end:{line:173,column:14}},"72":{start:{line:93,column:19},end:{line:99,column:22}},"73":{start:{line:94,column:23},end:{line:97,column:46}},"74":{start:{line:95,column:27},end:{line:95,column:93}},"75":{start:{line:97,column:27},end:{line:97,column:46}},"76":{start:{line:98,column:23},end:{line:98,column:46}},"77":{start:{line:101,column:19},end:{line:117,column:20}},"78":{start:{line:102,column:23},end:{line:102,column:69}},"79":{start:{line:103,column:36},end:{line:103,column:88}},"80":{start:{line:104,column:23},end:{line:113,column:26}},"81":{start:{line:105,column:27},end:{line:111,column:28}},"82":{start:{line:106,column:31},end:{line:106,column:60}},"83":{start:{line:109,column:31},end:{line:109,column:93}},"84":{start:{line:112,column:27},end:{line:112,column:52}},"85":{start:{line:115,column:23},end:{line:115,column:76}},"86":{start:{line:116,column:23},end:{line:116,column:44}},"87":{start:{line:119,column:19},end:{line:164,column:22}},"88":{start:{line:121,column:36},end:{line:127,column:39}},"89":{start:{line:122,column:40},end:{line:125,column:63}},"90":{start:{line:123,column:44},end:{line:123,column:110}},"91":{start:{line:125,column:44},end:{line:125,column:63}},"92":{start:{line:126,column:40},end:{line:126,column:63}},"93":{start:{line:129,column:61},end:{line:129,column:156}},"94":{start:{line:130,column:36},end:{line:139,column:39}},"95":{start:{line:131,column:40},end:{line:137,column:76}},"96":{start:{line:132,column:44},end:{line:132,column:73}},"97":{start:{line:133,column:45},end:{line:137,column:76}},"98":{start:{line:134,column:44},end:{line:134,column:74}},"99":{start:{line:137,column:44},end:{line:137,column:76}},"100":{start:{line:138,column:40},end:{line:138,column:64}},"101":{start:{line:141,column:36},end:{line:155,column:61}},"102":{start:{line:142,column:40},end:{line:142,column:130}},"103":{start:{line:143,column:53},end:{line:143,column:145}},"104":{start:{line:144,column:40},end:{line:153,column:43}},"105":{start:{line:145,column:44},end:{line:151,column:45}},"106":{start:{line:146,column:48},end:{line:146,column:77}},"107":{start:{line:149,column:48},end:{line:149,column:103}},"108":{start:{line:152,column:44},end:{line:152,column:69}},"109":{start:{line:155,column:40},end:{line:155,column:61}},"110":{start:{line:159,column:23},end:{line:162,column:103}},"111":{start:{line:162,column:27},end:{line:162,column:103}},"112":{start:{line:163,column:23},end:{line:163,column:45}},"113":{start:{line:168,column:15},end:{line:171,column:93}},"114":{start:{line:171,column:19},end:{line:171,column:93}},"115":{start:{line:172,column:15},end:{line:172,column:37}},"116":{start:{line:176,column:11},end:{line:181,column:76}},"117":{start:{line:179,column:15},end:{line:179,column:60}},"118":{start:{line:181,column:15},end:{line:181,column:76}},"119":{start:{line:182,column:11},end:{line:182,column:33}},"120":{start:{line:186,column:12},end:{line:196,column:13}},"121":{start:{line:187,column:16},end:{line:187,column:81}},"122":{start:{line:188,column:16},end:{line:188,column:46}},"123":{start:{line:189,column:16},end:{line:189,column:53}},"124":{start:{line:195,column:16},end:{line:195,column:38}},"125":{start:{line:199,column:8},end:{line:199,column:24}},"126":{start:{line:200,column:8},end:{line:200,column:26}},"127":{start:{line:203,column:0},end:{line:203,column:30}}},fnMap:{"0":{name:"Registration",decl:{start:{line:6,column:9},end:{line:6,column:21}},loc:{start:{line:6,column:38},end:{line:202,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:24,column:34},end:{line:24,column:35}},loc:{start:{line:24,column:39},end:{line:24,column:91}},line:24},"2":{name:"(anonymous_2)",decl:{start:{line:36,column:21},end:{line:36,column:22}},loc:{start:{line:36,column:50},end:{line:50,column:5}},line:36},"3":{name:"(anonymous_3)",decl:{start:{line:39,column:32},end:{line:39,column:33}},loc:{start:{line:39,column:57},end:{line:49,column:9}},line:39},"4":{name:"(anonymous_4)",decl:{start:{line:53,column:3},end:{line:53,column:4}},loc:{start:{line:53,column:23},end:{line:66,column:4}},line:53},"5":{name:"(anonymous_5)",decl:{start:{line:55,column:31},end:{line:55,column:32}},loc:{start:{line:55,column:56},end:{line:65,column:8}},line:55},"6":{name:"(anonymous_6)",decl:{start:{line:66,column:6},end:{line:66,column:7}},loc:{start:{line:66,column:26},end:{line:86,column:4}},line:66},"7":{name:"(anonymous_7)",decl:{start:{line:71,column:52},end:{line:71,column:53}},loc:{start:{line:71,column:77},end:{line:83,column:12}},line:71},"8":{name:"(anonymous_8)",decl:{start:{line:86,column:6},end:{line:86,column:7}},loc:{start:{line:86,column:26},end:{line:184,column:4}},line:86},"9":{name:"(anonymous_9)",decl:{start:{line:88,column:28},end:{line:88,column:29}},loc:{start:{line:88,column:57},end:{line:174,column:8}},line:88},"10":{name:"(anonymous_10)",decl:{start:{line:92,column:24},end:{line:92,column:25}},loc:{start:{line:92,column:44},end:{line:100,column:16}},line:92},"11":{name:"(anonymous_11)",decl:{start:{line:93,column:39},end:{line:93,column:40}},loc:{start:{line:93,column:62},end:{line:99,column:20}},line:93},"12":{name:"(anonymous_12)",decl:{start:{line:100,column:18},end:{line:100,column:19}},loc:{start:{line:100,column:38},end:{line:118,column:16}},line:100},"13":{name:"(anonymous_13)",decl:{start:{line:104,column:40},end:{line:104,column:41}},loc:{start:{line:104,column:66},end:{line:113,column:24}},line:104},"14":{name:"(anonymous_14)",decl:{start:{line:118,column:18},end:{line:118,column:19}},loc:{start:{line:118,column:38},end:{line:165,column:16}},line:118},"15":{name:"(anonymous_15)",decl:{start:{line:120,column:32},end:{line:120,column:33}},loc:{start:{line:120,column:52},end:{line:128,column:33}},line:120},"16":{name:"(anonymous_16)",decl:{start:{line:121,column:56},end:{line:121,column:57}},loc:{start:{line:121,column:79},end:{line:127,column:37}},line:121},"17":{name:"(anonymous_17)",decl:{start:{line:128,column:35},end:{line:128,column:36}},loc:{start:{line:128,column:55},end:{line:140,column:33}},line:128},"18":{name:"(anonymous_18)",decl:{start:{line:130,column:65},end:{line:130,column:66}},loc:{start:{line:130,column:90},end:{line:139,column:37}},line:130},"19":{name:"(anonymous_19)",decl:{start:{line:140,column:35},end:{line:140,column:36}},loc:{start:{line:140,column:55},end:{line:156,column:33}},line:140},"20":{name:"(anonymous_20)",decl:{start:{line:144,column:57},end:{line:144,column:58}},loc:{start:{line:144,column:83},end:{line:153,column:41}},line:144},"21":{name:"(anonymous_21)",decl:{start:{line:157,column:22},end:{line:157,column:23}},loc:{start:{line:157,column:45},end:{line:164,column:20}},line:157},"22":{name:"(anonymous_22)",decl:{start:{line:166,column:14},end:{line:166,column:15}},loc:{start:{line:166,column:37},end:{line:173,column:12}},line:166},"23":{name:"(anonymous_23)",decl:{start:{line:174,column:10},end:{line:174,column:11}},loc:{start:{line:174,column:33},end:{line:183,column:8}},line:174},"24":{name:"(anonymous_24)",decl:{start:{line:185,column:5},end:{line:185,column:6}},loc:{start:{line:185,column:28},end:{line:197,column:3}},line:185}},branchMap:{"0":{loc:{start:{line:12,column:4},end:{line:17,column:35}},type:"if",locations:[{start:{line:12,column:4},end:{line:17,column:35}},{start:{line:12,column:4},end:{line:17,column:35}}],line:12},"1":{loc:{start:{line:12,column:8},end:{line:12,column:77}},type:"binary-expr",locations:[{start:{line:12,column:8},end:{line:12,column:43}},{start:{line:12,column:47},end:{line:12,column:77}}],line:12},"2":{loc:{start:{line:14,column:9},end:{line:17,column:35}},type:"if",locations:[{start:{line:14,column:9},end:{line:17,column:35}},{start:{line:14,column:9},end:{line:17,column:35}}],line:14},"3":{loc:{start:{line:18,column:4},end:{line:35,column:5}},type:"if",locations:[{start:{line:18,column:4},end:{line:35,column:5}},{start:{line:18,column:4},end:{line:35,column:5}}],line:18},"4":{loc:{start:{line:18,column:8},end:{line:18,column:71}},type:"binary-expr",locations:[{start:{line:18,column:8},end:{line:18,column:39}},{start:{line:18,column:43},end:{line:18,column:71}}],line:18},"5":{loc:{start:{line:19,column:8},end:{line:30,column:9}},type:"if",locations:[{start:{line:19,column:8},end:{line:30,column:9}},{start:{line:19,column:8},end:{line:30,column:9}}],line:19},"6":{loc:{start:{line:20,column:12},end:{line:21,column:42}},type:"if",locations:[{start:{line:20,column:12},end:{line:21,column:42}},{start:{line:20,column:12},end:{line:21,column:42}}],line:20},"7":{loc:{start:{line:24,column:41},end:{line:24,column:89}},type:"if",locations:[{start:{line:24,column:41},end:{line:24,column:89}},{start:{line:24,column:41},end:{line:24,column:89}}],line:24},"8":{loc:{start:{line:25,column:12},end:{line:29,column:13}},type:"if",locations:[{start:{line:25,column:12},end:{line:29,column:13}},{start:{line:25,column:12},end:{line:29,column:13}}],line:25},"9":{loc:{start:{line:26,column:16},end:{line:27,column:46}},type:"if",locations:[{start:{line:26,column:16},end:{line:27,column:46}},{start:{line:26,column:16},end:{line:27,column:46}}],line:26},"10":{loc:{start:{line:32,column:8},end:{line:33,column:38}},type:"if",locations:[{start:{line:32,column:8},end:{line:33,column:38}},{start:{line:32,column:8},end:{line:33,column:38}}],line:32},"11":{loc:{start:{line:40,column:12},end:{line:46,column:55}},type:"if",locations:[{start:{line:40,column:12},end:{line:46,column:55}},{start:{line:40,column:12},end:{line:46,column:55}}],line:40},"12":{loc:{start:{line:42,column:17},end:{line:46,column:55}},type:"if",locations:[{start:{line:42,column:17},end:{line:46,column:55}},{start:{line:42,column:17},end:{line:46,column:55}}],line:42},"13":{loc:{start:{line:51,column:4},end:{line:201,column:5}},type:"if",locations:[{start:{line:51,column:4},end:{line:201,column:5}},{start:{line:51,column:4},end:{line:201,column:5}}],line:51},"14":{loc:{start:{line:51,column:8},end:{line:51,column:45}},type:"binary-expr",locations:[{start:{line:51,column:8},end:{line:51,column:22}},{start:{line:51,column:26},end:{line:51,column:45}}],line:51},"15":{loc:{start:{line:56,column:11},end:{line:63,column:52}},type:"if",locations:[{start:{line:56,column:11},end:{line:63,column:52}},{start:{line:56,column:11},end:{line:63,column:52}}],line:56},"16":{loc:{start:{line:58,column:16},end:{line:63,column:52}},type:"if",locations:[{start:{line:58,column:16},end:{line:63,column:52}},{start:{line:58,column:16},end:{line:63,column:52}}],line:58},"17":{loc:{start:{line:68,column:7},end:{line:85,column:32}},type:"if",locations:[{start:{line:68,column:7},end:{line:85,column:32}},{start:{line:68,column:7},end:{line:85,column:32}}],line:68},"18":{loc:{start:{line:72,column:15},end:{line:81,column:16}},type:"if",locations:[{start:{line:72,column:15},end:{line:81,column:16}},{start:{line:72,column:15},end:{line:81,column:16}}],line:72},"19":{loc:{start:{line:76,column:19},end:{line:80,column:88}},type:"if",locations:[{start:{line:76,column:19},end:{line:80,column:88}},{start:{line:76,column:19},end:{line:80,column:88}}],line:76},"20":{loc:{start:{line:94,column:23},end:{line:97,column:46}},type:"if",locations:[{start:{line:94,column:23},end:{line:97,column:46}},{start:{line:94,column:23},end:{line:97,column:46}}],line:94},"21":{loc:{start:{line:101,column:19},end:{line:117,column:20}},type:"if",locations:[{start:{line:101,column:19},end:{line:117,column:20}},{start:{line:101,column:19},end:{line:117,column:20}}],line:101},"22":{loc:{start:{line:105,column:27},end:{line:111,column:28}},type:"if",locations:[{start:{line:105,column:27},end:{line:111,column:28}},{start:{line:105,column:27},end:{line:111,column:28}}],line:105},"23":{loc:{start:{line:122,column:40},end:{line:125,column:63}},type:"if",locations:[{start:{line:122,column:40},end:{line:125,column:63}},{start:{line:122,column:40},end:{line:125,column:63}}],line:122},"24":{loc:{start:{line:131,column:40},end:{line:137,column:76}},type:"if",locations:[{start:{line:131,column:40},end:{line:137,column:76}},{start:{line:131,column:40},end:{line:137,column:76}}],line:131},"25":{loc:{start:{line:133,column:45},end:{line:137,column:76}},type:"if",locations:[{start:{line:133,column:45},end:{line:137,column:76}},{start:{line:133,column:45},end:{line:137,column:76}}],line:133},"26":{loc:{start:{line:141,column:36},end:{line:155,column:61}},type:"if",locations:[{start:{line:141,column:36},end:{line:155,column:61}},{start:{line:141,column:36},end:{line:155,column:61}}],line:141},"27":{loc:{start:{line:145,column:44},end:{line:151,column:45}},type:"if",locations:[{start:{line:145,column:44},end:{line:151,column:45}},{start:{line:145,column:44},end:{line:151,column:45}}],line:145},"28":{loc:{start:{line:159,column:23},end:{line:162,column:103}},type:"if",locations:[{start:{line:159,column:23},end:{line:162,column:103}},{start:{line:159,column:23},end:{line:162,column:103}}],line:159},"29":{loc:{start:{line:168,column:15},end:{line:171,column:93}},type:"if",locations:[{start:{line:168,column:15},end:{line:171,column:93}},{start:{line:168,column:15},end:{line:171,column:93}}],line:168},"30":{loc:{start:{line:176,column:11},end:{line:181,column:76}},type:"if",locations:[{start:{line:176,column:11},end:{line:181,column:76}},{start:{line:176,column:11},end:{line:181,column:76}}],line:176},"31":{loc:{start:{line:186,column:12},end:{line:196,column:13}},type:"if",locations:[{start:{line:186,column:12},end:{line:196,column:13}},{start:{line:186,column:12},end:{line:196,column:13}}],line:186},"32":{loc:{start:{line:188,column:27},end:{line:188,column:44}},type:"binary-expr",locations:[{start:{line:188,column:27},end:{line:188,column:37}},{start:{line:188,column:41},end:{line:188,column:44}}],line:188}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"cd48076a28925ea1513c1a2d982a58b93a859cab"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_19wsuprknc=function(){return actualCoverage;};}return actualCoverage;}cov_19wsuprknc();var express=(cov_19wsuprknc().s[0]++,require('express'));var emailvalidator=(cov_19wsuprknc().s[1]++,require('email-validator'));var router=(cov_19wsuprknc().s[2]++,express.Router());var db=(cov_19wsuprknc().s[3]++,require('../lib/db.js'));var async=(cov_19wsuprknc().s[4]++,require('async'));function Registration(req,res,next){cov_19wsuprknc().f[0]++;var teacherID=(cov_19wsuprknc().s[5]++,-1);var message=(cov_19wsuprknc().s[6]++,{'message':'Calling /api/register'});cov_19wsuprknc().s[7]++;console.log("POST /api/register req: "+JSON.stringify(req.body));var teacher=(cov_19wsuprknc().s[8]++,'');var students=(cov_19wsuprknc().s[9]++,[]);cov_19wsuprknc().s[10]++;if((cov_19wsuprknc().b[1][0]++,!req.body.hasOwnProperty('teacher'))||(cov_19wsuprknc().b[1][1]++,req.body.teacher===undefined)){cov_19wsuprknc().b[0][0]++;cov_19wsuprknc().s[11]++;message.message+=' without a teacher specified!';}else{cov_19wsuprknc().b[0][1]++;cov_19wsuprknc().s[12]++;if(emailvalidator.validate(req.body.teacher)===false){cov_19wsuprknc().b[2][0]++;cov_19wsuprknc().s[13]++;message.message+=' with invalid teacher email address!';}else{cov_19wsuprknc().b[2][1]++;cov_19wsuprknc().s[14]++;teacher=req.body.teacher;}}cov_19wsuprknc().s[15]++;if((cov_19wsuprknc().b[4][0]++,req.body.students!==undefined)&&(cov_19wsuprknc().b[4][1]++,req.body.students.length>0)){cov_19wsuprknc().b[3][0]++;cov_19wsuprknc().s[16]++;if(!Array.isArray(req.body.students)){cov_19wsuprknc().b[5][0]++;cov_19wsuprknc().s[17]++;if(teacher===''){cov_19wsuprknc().b[6][0]++;cov_19wsuprknc().s[18]++;message.message+=' and';}else{cov_19wsuprknc().b[6][1]++;}cov_19wsuprknc().s[19]++;message.message+=' without a list of students specified!';}else{cov_19wsuprknc().b[5][1]++;cov_19wsuprknc().s[20]++;req.body.students.map(i=>{cov_19wsuprknc().f[1]++;cov_19wsuprknc().s[21]++;if(emailvalidator.validate(i)){cov_19wsuprknc().b[7][0]++;cov_19wsuprknc().s[22]++;students.push(i);}else{cov_19wsuprknc().b[7][1]++;}});cov_19wsuprknc().s[23]++;if(students.length==0){cov_19wsuprknc().b[8][0]++;cov_19wsuprknc().s[24]++;if(teacher===''){cov_19wsuprknc().b[9][0]++;cov_19wsuprknc().s[25]++;message.message+=' and';}else{cov_19wsuprknc().b[9][1]++;}cov_19wsuprknc().s[26]++;message.message+=' without any student with valid email address specified!';}else{cov_19wsuprknc().b[8][1]++;}}}else{cov_19wsuprknc().b[3][1]++;cov_19wsuprknc().s[27]++;if(teacher===''){cov_19wsuprknc().b[10][0]++;cov_19wsuprknc().s[28]++;message.message+=' and';}else{cov_19wsuprknc().b[10][1]++;}cov_19wsuprknc().s[29]++;message.message+=' without a valid list of students specified!';}cov_19wsuprknc().s[30]++;var getStudent=function(student,callback){cov_19wsuprknc().f[2]++;var studentID=(cov_19wsuprknc().s[31]++,-1);var student_query=(cov_19wsuprknc().s[32]++,`select id from students where email = '${student}'`);cov_19wsuprknc().s[33]++;db.query(student_query,function(error,result){cov_19wsuprknc().f[3]++;cov_19wsuprknc().s[34]++;if(error){cov_19wsuprknc().b[11][0]++;cov_19wsuprknc().s[35]++;console.error(error.message);}else{cov_19wsuprknc().b[11][1]++;cov_19wsuprknc().s[36]++;if(result.length>0){cov_19wsuprknc().b[12][0]++;cov_19wsuprknc().s[37]++;studentID=result[0].id;cov_19wsuprknc().s[38]++;console.log(`Existing student: ${studentID}`);}else{cov_19wsuprknc().b[12][1]++;cov_19wsuprknc().s[39]++;console.log(`New student: ${student}`);}}cov_19wsuprknc().s[40]++;console.log("calling back...");cov_19wsuprknc().s[41]++;callback(error,studentID);});};cov_19wsuprknc().s[42]++;if((cov_19wsuprknc().b[14][0]++,teacher!=='')&&(cov_19wsuprknc().b[14][1]++,students.length>0)){cov_19wsuprknc().b[13][0]++;cov_19wsuprknc().s[43]++;async.series([function(callback){cov_19wsuprknc().f[4]++;var teacher_query=(cov_19wsuprknc().s[44]++,`select id from teachers where email = '${teacher}'`);cov_19wsuprknc().s[45]++;db.query(teacher_query,function(error,result){cov_19wsuprknc().f[5]++;cov_19wsuprknc().s[46]++;if(error){cov_19wsuprknc().b[15][0]++;cov_19wsuprknc().s[47]++;console.error(`Database error: ${error.message}`);}else{cov_19wsuprknc().b[15][1]++;cov_19wsuprknc().s[48]++;if(result.length>0){cov_19wsuprknc().b[16][0]++;cov_19wsuprknc().s[49]++;teacherID=result[0].id;cov_19wsuprknc().s[50]++;console.log(`Get teacher: ${teacherID}`);//console.log('rows: '+rows+);
}else{cov_19wsuprknc().b[16][1]++;cov_19wsuprknc().s[51]++;console.log(`No teacher ${teacher}`);}}cov_19wsuprknc().s[52]++;callback(error,result);});},function(callback){cov_19wsuprknc().f[6]++;cov_19wsuprknc().s[53]++;console.log(`teacher ${teacherID}`);cov_19wsuprknc().s[54]++;if(teacherID===-1){cov_19wsuprknc().b[17][0]++;cov_19wsuprknc().s[55]++;console.log(`Add new teacher ${teacher}`);var teacher_query=(cov_19wsuprknc().s[56]++,`INSERT INTO teachers (email) VALUES ('${teacher}')`);var newTeacher=(cov_19wsuprknc().s[57]++,db.query(teacher_query,function(error,result){cov_19wsuprknc().f[7]++;cov_19wsuprknc().s[58]++;if(error){cov_19wsuprknc().b[18][0]++;cov_19wsuprknc().s[59]++;console.error(error.message);}// if error occured during connection 
else{cov_19wsuprknc().b[18][1]++;cov_19wsuprknc().s[60]++;// rows: {"fieldCount":0,"affectedRows":1,"insertId":2,"serverStatus":2,"warningCount":0,"message":"","protocol41":true,"changedRows":0}
if(result.affectedRows===1){cov_19wsuprknc().b[19][0]++;cov_19wsuprknc().s[61]++;teacherID=result.insertId;cov_19wsuprknc().s[62]++;console.log(`Teacher ${teacher} inserted successfully. ID: ${teacherID}`);}else{cov_19wsuprknc().b[19][1]++;cov_19wsuprknc().s[63]++;console.error(`Failed inserting new teacher. ${result.message}`);}}cov_19wsuprknc().s[64]++;callback(error,result);}));}else{cov_19wsuprknc().b[17][1]++;cov_19wsuprknc().s[65]++;callback(null,null);}},function(callback){cov_19wsuprknc().f[8]++;cov_19wsuprknc().s[66]++;console.log(`Processing ${students.length} students...`);cov_19wsuprknc().s[67]++;async.each(students,function(student,callback){cov_19wsuprknc().f[9]++;var studentID=(cov_19wsuprknc().s[68]++,-1),relationshipID=(cov_19wsuprknc().s[69]++,-1);cov_19wsuprknc().s[70]++;console.log(`Processing student: ${student}`);cov_19wsuprknc().s[71]++;async.series([function(callback){cov_19wsuprknc().f[10]++;cov_19wsuprknc().s[72]++;getStudent(student,function(err,result){cov_19wsuprknc().f[11]++;cov_19wsuprknc().s[73]++;if(err){cov_19wsuprknc().b[20][0]++;cov_19wsuprknc().s[74]++;console.error("getStudent() failed! err: "+JSON.stringify(err));}else{cov_19wsuprknc().b[20][1]++;cov_19wsuprknc().s[75]++;studentID=result;}cov_19wsuprknc().s[76]++;callback(null,result);});},function(callback){cov_19wsuprknc().f[12]++;cov_19wsuprknc().s[77]++;if(studentID===-1){cov_19wsuprknc().b[21][0]++;cov_19wsuprknc().s[78]++;// New Student
console.log(`Process new student ${student}`);var insert=(cov_19wsuprknc().s[79]++,`INSERT INTO students (email) VALUES ('${student}')`);cov_19wsuprknc().s[80]++;db.query(insert,function(error,results){cov_19wsuprknc().f[13]++;cov_19wsuprknc().s[81]++;if(error){cov_19wsuprknc().b[22][0]++;cov_19wsuprknc().s[82]++;console.error(error.message);// if error occured during connection 
//context.fail('Error executing database query to Insert the booking');
}else{cov_19wsuprknc().b[22][1]++;cov_19wsuprknc().s[83]++;console.log('Student '+student+' inserted successfully ');//context.done(null, 'Student record inserted successfully ' + student);	    				
}cov_19wsuprknc().s[84]++;callback(error,results);});}else{cov_19wsuprknc().b[21][1]++;cov_19wsuprknc().s[85]++;// Existing student
console.log(`Process existing student ${studentID}`);cov_19wsuprknc().s[86]++;callback(null,null);}},function(callback){cov_19wsuprknc().f[14]++;cov_19wsuprknc().s[87]++;// Process many-to-many relationships
async.series([function(callback){cov_19wsuprknc().f[15]++;cov_19wsuprknc().s[88]++;// Get Student ID
getStudent(student,function(err,result){cov_19wsuprknc().f[16]++;cov_19wsuprknc().s[89]++;if(err){cov_19wsuprknc().b[23][0]++;cov_19wsuprknc().s[90]++;console.error("getStudent() failed! err: "+JSON.stringify(err));}else{cov_19wsuprknc().b[23][1]++;cov_19wsuprknc().s[91]++;studentID=result;}cov_19wsuprknc().s[92]++;callback(null,result);});},function(callback){cov_19wsuprknc().f[17]++;// Get existing relationship, if any
var relationship_query=(cov_19wsuprknc().s[93]++,`select id from teacher_student where teacherid = '${teacherID}' && studentid = '${studentID}'`);cov_19wsuprknc().s[94]++;db.query(relationship_query,function(error,result){cov_19wsuprknc().f[18]++;cov_19wsuprknc().s[95]++;if(error){cov_19wsuprknc().b[24][0]++;cov_19wsuprknc().s[96]++;console.error(error.message);}else{cov_19wsuprknc().b[24][1]++;cov_19wsuprknc().s[97]++;if(result.length>0){cov_19wsuprknc().b[25][0]++;cov_19wsuprknc().s[98]++;relationshipID=result[0].id;//console.log(`Get relationship: ${relationshipID}`);
}else{cov_19wsuprknc().b[25][1]++;cov_19wsuprknc().s[99]++;console.log("No relationship!");}}cov_19wsuprknc().s[100]++;callback(error,result);});},function(callback){cov_19wsuprknc().f[19]++;cov_19wsuprknc().s[101]++;if(relationshipID===-1){cov_19wsuprknc().b[26][0]++;cov_19wsuprknc().s[102]++;console.log(`Add new relationship between teacher ${teacherID} and student ${studentID}`);var insert=(cov_19wsuprknc().s[103]++,`INSERT INTO teacher_student (teacherid, studentid) VALUES ('${teacherID}', '${studentID}')`);cov_19wsuprknc().s[104]++;db.query(insert,function(error,results){cov_19wsuprknc().f[20]++;cov_19wsuprknc().s[105]++;if(error){cov_19wsuprknc().b[27][0]++;cov_19wsuprknc().s[106]++;console.error(error.message);// if error occured during connection 
//context.fail('Error executing database query to Insert the booking');
}else{cov_19wsuprknc().b[27][1]++;cov_19wsuprknc().s[107]++;console.log('New relationship inserted successfully ');//context.done(null, 'Student record inserted successfully ' + student);	    				
}cov_19wsuprknc().s[108]++;callback(error,results);});}else{cov_19wsuprknc().b[26][1]++;cov_19wsuprknc().s[109]++;callback(null,null);}}],function(err,result){cov_19wsuprknc().f[21]++;cov_19wsuprknc().s[110]++;// if any of the file processing produced an error, err would equal that error
if(err){cov_19wsuprknc().b[28][0]++;cov_19wsuprknc().s[111]++;// One of the iterations produced an error.
// All processing will now stop.
console.error('A student failed to process. Error: '+JSON.stringify(err));}else{cov_19wsuprknc().b[28][1]++;}cov_19wsuprknc().s[112]++;callback(err,result);});}],function(err,result){cov_19wsuprknc().f[22]++;cov_19wsuprknc().s[113]++;// if any of the file processing produced an error, err would equal that error
if(err){cov_19wsuprknc().b[29][0]++;cov_19wsuprknc().s[114]++;// One of the iterations produced an error.
// All processing will now stop.
console.error('A student failed to process. Error: '+JSON.stringify(err));}else{cov_19wsuprknc().b[29][1]++;}cov_19wsuprknc().s[115]++;callback(err,result);});},function(err,result){cov_19wsuprknc().f[23]++;cov_19wsuprknc().s[116]++;// if any of the file processing produced an error, err would equal that error
if(err){cov_19wsuprknc().b[30][0]++;cov_19wsuprknc().s[117]++;// One of the iterations produced an error.
// All processing will now stop.
console.error('A student failed to process');}else{cov_19wsuprknc().b[30][1]++;cov_19wsuprknc().s[118]++;console.log('All students have been processed successfully');}cov_19wsuprknc().s[119]++;callback(err,result);});}],function(err,results){cov_19wsuprknc().f[24]++;cov_19wsuprknc().s[120]++;if(err){cov_19wsuprknc().b[31][0]++;cov_19wsuprknc().s[121]++;console.error("/api/registration Error: "+JSON.stringify(err));cov_19wsuprknc().s[122]++;res.status((cov_19wsuprknc().b[32][0]++,err.status)||(cov_19wsuprknc().b[32][1]++,500));cov_19wsuprknc().s[123]++;res.json({'message':err.message});}else{cov_19wsuprknc().b[31][1]++;cov_19wsuprknc().s[124]++;// Index of results:
// 0: result from the first serial function
// 1: results from the second serial function
//console.log("register result: " + JSON.stringify(results));
res.status(204).end();}});}else{cov_19wsuprknc().b[13][1]++;cov_19wsuprknc().s[125]++;// if (teacher !=='' && students.length > 0) {
res.status(400);cov_19wsuprknc().s[126]++;res.json(message);}};cov_19wsuprknc().s[127]++;module.exports=Registration;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZ2lzdHJhdGlvbi5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImVtYWlsdmFsaWRhdG9yIiwicm91dGVyIiwiUm91dGVyIiwiZGIiLCJhc3luYyIsIlJlZ2lzdHJhdGlvbiIsInJlcSIsInJlcyIsIm5leHQiLCJ0ZWFjaGVySUQiLCJtZXNzYWdlIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJib2R5IiwidGVhY2hlciIsInN0dWRlbnRzIiwiaGFzT3duUHJvcGVydHkiLCJ1bmRlZmluZWQiLCJ2YWxpZGF0ZSIsImxlbmd0aCIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsImkiLCJwdXNoIiwiZ2V0U3R1ZGVudCIsInN0dWRlbnQiLCJjYWxsYmFjayIsInN0dWRlbnRJRCIsInN0dWRlbnRfcXVlcnkiLCJxdWVyeSIsImVycm9yIiwicmVzdWx0IiwiaWQiLCJzZXJpZXMiLCJ0ZWFjaGVyX3F1ZXJ5IiwibmV3VGVhY2hlciIsImFmZmVjdGVkUm93cyIsImluc2VydElkIiwiZWFjaCIsInJlbGF0aW9uc2hpcElEIiwiZXJyIiwiaW5zZXJ0IiwicmVzdWx0cyIsInJlbGF0aW9uc2hpcF9xdWVyeSIsInN0YXR1cyIsImpzb24iLCJlbmQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoidzFtQkFlWTsyRkFmWixHQUFJQSxDQUFBQSxPQUFPLDBCQUFHQyxPQUFPLENBQUMsU0FBRCxDQUFWLENBQVgsQ0FDQSxHQUFJQyxDQUFBQSxjQUFjLDBCQUFHRCxPQUFPLENBQUMsaUJBQUQsQ0FBVixDQUFsQixDQUNBLEdBQUlFLENBQUFBLE1BQU0sMEJBQUdILE9BQU8sQ0FBQ0ksTUFBUixFQUFILENBQVYsQ0FDQSxHQUFJQyxDQUFBQSxFQUFFLDBCQUFHSixPQUFPLENBQUMsY0FBRCxDQUFWLENBQU4sQ0FDQSxHQUFJSyxDQUFBQSxLQUFLLDBCQUFHTCxPQUFPLENBQUMsT0FBRCxDQUFWLENBQVQsQ0FDQSxRQUFTTSxDQUFB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UyxDQUFFLFVBQVdMLEdBQUcsQ0FBQ2pDLE9BQWpCLENBQVQsRUFDSCxDQUpELElBSU8sdURBQ1o7QUFDSDtBQUNZO0FBQ0E7QUFDQUgsR0FBRyxDQUFDd0MsTUFBSixDQUFXLEdBQVgsRUFBZ0JFLEdBQWhCLEdBQ0gsQ0FDVixDQWpKRCxFQWtKRyxDQW5KRCxJQW1KTyx1REFBRTtBQUNMMUMsR0FBRyxDQUFDd0MsTUFBSixDQUFXLEdBQVgsRUFERywwQkFFSHhDLEdBQUcsQ0FBQ3lDLElBQUosQ0FBU3RDLE9BQVQsRUFDSCxDQUNKLEUsMEJBQ0R3QyxNQUFNLENBQUNDLE9BQVAsQ0FBaUI5QyxZQUFqQiIsInNvdXJjZXNDb250ZW50IjpbInZhciBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG52YXIgZW1haWx2YWxpZGF0b3IgPSByZXF1aXJlKCdlbWFpbC12YWxpZGF0b3InKTtcclxudmFyIHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbnZhciBkYiA9IHJlcXVpcmUoJy4uL2xpYi9kYi5qcycpO1xyXG52YXIgYXN5bmMgPSByZXF1aXJlKCdhc3luYycpO1xyXG5mdW5jdGlvbiBSZWdpc3RyYXRpb24ocmVxLCByZXMsIG5leHQpIHtcclxuICAgIHZhciB0ZWFjaGVySUQgPSAtMTtcclxuICAgIHZhciBtZXNzYWdlID0geydtZXNzYWdlJzogJ0NhbGxpbmcgL2FwaS9yZWdpc3Rlcid9O1xyXG4gICAgY29uc29sZS5sb2coXCJQT1NUIC9hcGkvcmVnaXN0ZXIgcmVxOiBcIiArIEpTT04uc3RyaW5naWZ5KHJlcS5ib2R5KSk7XHJcbiAgICB2YXIgdGVhY2hlciA9ICcnO1xyXG4gICAgdmFyIHN0dWRlbnRzID0gW107XHJcbiAgICBpZiAoIXJlcS5ib2R5Lmhhc093blByb3BlcnR5KCd0ZWFjaGVyJykgfHwgcmVxLmJvZHkudGVhY2hlciA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIG1lc3NhZ2UubWVzc2FnZSArPSAnIHdpdGhvdXQgYSB0ZWFjaGVyIHNwZWNpZmllZCEnO1xyXG4gICAgZWxzZSBpZiAoZW1haWx2YWxpZGF0b3IudmFsaWRhdGUocmVxLmJvZHkudGVhY2hlcikgPT09IGZhbHNlKVxyXG4gICAgICAgIG1lc3NhZ2UubWVzc2FnZSArPSAnIHdpdGggaW52YWxpZCB0ZWFjaGVyIGVtYWlsIGFkZHJlc3MhJztcclxuICAgIGVsc2VcclxuICAgICAgICB0ZWFjaGVyID0gcmVxLmJvZHkudGVhY2hlcjtcclxuICAgIGlmIChyZXEuYm9keS5zdHVkZW50cyAhPT0gdW5kZWZpbmVkICYmIHJlcS5ib2R5LnN0dWRlbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocmVxLmJvZHkuc3R1ZGVudHMpKSB7XHJcbiAgICAgICAgICAgIGlmICh0ZWFjaGVyID09PSAnJylcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZSArPSAnIGFuZCc7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UubWVzc2FnZSArPSAnIHdpdGhvdXQgYSBsaXN0IG9mIHN0dWRlbnRzIHNwZWNpZmllZCEnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlcS5ib2R5LnN0dWRlbnRzLm1hcChpID0+IHsgaWYgKGVtYWlsdmFsaWRhdG9yLnZhbGlkYXRlKGkpKSBzdHVkZW50cy5wdXNoKGkpIH0pO1xyXG4gICAgICAgICAgICBpZiAoc3R1ZGVudHMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ZWFjaGVyID09PSAnJylcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLm1lc3NhZ2UgKz0gJyBhbmQnO1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZS5tZXNzYWdlICs9ICcgd2l0aG91dCBhbnkgc3R1ZGVudCB3aXRoIHZhbGlkIGVtYWlsIGFkZHJlc3Mgc3BlY2lmaWVkISc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmICh0ZWFjaGVyID09PSAnJylcclxuICAgICAgICAgICAgbWVzc2FnZS5tZXNzYWdlICs9ICcgYW5kJztcclxuICAgICAgICBtZXNzYWdlLm1lc3NhZ2UgKz0gJyB3aXRob3V0IGEgdmFsaWQgbGlzdCBvZiBzdHVkZW50cyBzcGVjaWZpZWQhJztcclxuICAgIH1cclxuICAgIHZhciBnZXRTdHVkZW50ID0gZnVuY3Rpb24gKHN0dWRlbnQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIHN0dWRlbnRJRCA9IC0xO1xyXG4gICAgICAgIHZhciBzdHVkZW50X3F1ZXJ5ID0gYHNlbGVjdCBpZCBmcm9tIHN0dWRlbnRzIHdoZXJlIGVtYWlsID0gJyR7c3R1ZGVudH0nYDtcclxuICAgICAgICBkYi5xdWVyeShzdHVkZW50X3F1ZXJ5LCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICBlbHNlIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgc3R1ZGVudElEID0gcmVzdWx0WzBdLmlkO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEV4aXN0aW5nIHN0dWRlbnQ6ICR7c3R1ZGVudElEfWApO1xyXG4gICAgICAgICAgICB9IGVsc2VcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBOZXcgc3R1ZGVudDogJHtzdHVkZW50fWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImNhbGxpbmcgYmFjay4uLlwiKTtcclxuICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHN0dWRlbnRJRCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGVhY2hlciAhPT0gJycgJiYgc3R1ZGVudHMubGVuZ3RoID4gMCkge1xyXG5cdFx0YXN5bmMuc2VyaWVzKFtcclxuXHRcdFx0ZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcblx0XHRcdCAgICB2YXIgdGVhY2hlcl9xdWVyeSA9IGBzZWxlY3QgaWQgZnJvbSB0ZWFjaGVycyB3aGVyZSBlbWFpbCA9ICcke3RlYWNoZXJ9J2A7XHJcblx0XHRcdCAgICBkYi5xdWVyeSh0ZWFjaGVyX3F1ZXJ5LCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xyXG5cdFx0XHQgICAgICAgIGlmIChlcnJvcilcclxuXHRcdFx0ICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRGF0YWJhc2UgZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcclxuXHRcdFx0ICAgICAgICBlbHNlIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xyXG5cdFx0XHQgICAgICAgICAgICB0ZWFjaGVySUQgPSByZXN1bHRbMF0uaWQ7XHJcblx0XHRcdCAgICAgICAgICAgIGNvbnNvbGUubG9nKGBHZXQgdGVhY2hlcjogJHt0ZWFjaGVySUR9YCk7XHJcblx0XHRcdCAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3Jvd3M6ICcrcm93cyspO1xyXG5cdFx0XHQgICAgICAgIH0gZWxzZVxyXG5cdFx0XHQgICAgICAgICAgICBjb25zb2xlLmxvZyhgTm8gdGVhY2hlciAke3RlYWNoZXJ9YCk7XHJcblx0XHRcdCAgICAgICAgY2FsbGJhY2soZXJyb3IsIHJlc3VsdCk7XHJcblx0XHRcdCAgICB9KTtcclxuXHRcdFx0fSwgZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcblx0XHRcdCAgICBjb25zb2xlLmxvZyhgdGVhY2hlciAke3RlYWNoZXJJRH1gKTtcclxuXHRcdFx0ICAgIGlmICh0ZWFjaGVySUQgPT09IC0xKSB7XHJcblx0XHRcdCAgICAgICAgY29uc29sZS5sb2coYEFkZCBuZXcgdGVhY2hlciAke3RlYWNoZXJ9YCk7XHJcblx0XHRcdCAgICAgICAgdmFyIHRlYWNoZXJfcXVlcnkgPSBgSU5TRVJUIElOVE8gdGVhY2hlcnMgKGVtYWlsKSBWQUxVRVMgKCcke3RlYWNoZXJ9JylgO1xyXG5cdFx0XHQgICAgICAgIHZhciBuZXdUZWFjaGVyID0gZGIucXVlcnkodGVhY2hlcl9xdWVyeSwgZnVuY3Rpb24gKGVycm9yLCByZXN1bHQpIHtcclxuXHRcdFx0ICAgICAgICAgICAgaWYgKGVycm9yKVxyXG5cdFx0XHQgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvci5tZXNzYWdlKTsgLy8gaWYgZXJyb3Igb2NjdXJlZCBkdXJpbmcgY29ubmVjdGlvbiBcclxuXHRcdFx0ICAgICAgICAgICAgZWxzZSB7XHJcblx0XHRcdCAgICAgICAgICAgICAgICAvLyByb3dzOiB7XCJmaWVsZENvdW50XCI6MCxcImFmZmVjdGVkUm93c1wiOjEsXCJpbnNlcnRJZFwiOjIsXCJzZXJ2ZXJTdGF0dXNcIjoyLFwid2FybmluZ0NvdW50XCI6MCxcIm1lc3NhZ2VcIjpcIlwiLFwicHJvdG9jb2w0MVwiOnRydWUsXCJjaGFuZ2VkUm93c1wiOjB9XHJcblx0XHRcdCAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMSkge1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgIHRlYWNoZXJJRCA9IHJlc3VsdC5pbnNlcnRJZDtcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgVGVhY2hlciAke3RlYWNoZXJ9IGluc2VydGVkIHN1Y2Nlc3NmdWxseS4gSUQ6ICR7dGVhY2hlcklEfWApO1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgfSBlbHNlXHJcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIGluc2VydGluZyBuZXcgdGVhY2hlci4gJHtyZXN1bHQubWVzc2FnZX1gKTtcclxuXHRcdFx0ICAgICAgICAgICAgfVxyXG5cdFx0XHQgICAgICAgICAgICBjYWxsYmFjayhlcnJvciwgcmVzdWx0KTtcclxuXHRcdFx0ICAgICAgICB9KTtcclxuXHRcdFx0ICAgIH0gZWxzZVxyXG5cdFx0XHQgICAgICAgIGNhbGxiYWNrKG51bGwsIG51bGwpO1xyXG5cdFx0XHR9LCBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuXHRcdFx0ICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nICR7c3R1ZGVudHMubGVuZ3RofSBzdHVkZW50cy4uLmApO1xyXG5cdFx0XHQgICAgYXN5bmMuZWFjaChzdHVkZW50cywgZnVuY3Rpb24gKHN0dWRlbnQsIGNhbGxiYWNrKSB7XHJcblx0XHRcdCAgICAgICAgdmFyIHN0dWRlbnRJRCA9IC0xLCByZWxhdGlvbnNoaXBJRCA9IC0xO1xyXG5cdFx0XHQgICAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nIHN0dWRlbnQ6ICR7c3R1ZGVudH1gKTtcclxuXHRcdFx0ICAgICAgICBhc3luYy5zZXJpZXMoW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuXHRcdFx0ICAgICAgICAgICAgICAgIGdldFN0dWRlbnQoc3R1ZGVudCwgZnVuY3Rpb24gKGVyciwgcmVzdWx0KSB7XHJcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgaWYgKGVycilcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcImdldFN0dWRlbnQoKSBmYWlsZWQhIGVycjogXCIgKyBKU09OLnN0cmluZ2lmeShlcnIpKTtcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICBlbHNlXHJcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgIHN0dWRlbnRJRCA9IHJlc3VsdDtcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHQpO1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgfSk7XHJcblx0XHRcdCAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgaWYgKHN0dWRlbnRJRCA9PT0gLTEpIHsgLy8gTmV3IFN0dWRlbnRcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2VzcyBuZXcgc3R1ZGVudCAke3N0dWRlbnR9YCk7XHJcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgdmFyIGluc2VydCA9IGBJTlNFUlQgSU5UTyBzdHVkZW50cyAoZW1haWwpIFZBTFVFUyAoJyR7c3R1ZGVudH0nKWA7XHJcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgZGIucXVlcnkoaW5zZXJ0LCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdHMpIHtcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XHJcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yLm1lc3NhZ2UpOyAvLyBpZiBlcnJvciBvY2N1cmVkIGR1cmluZyBjb25uZWN0aW9uIFxyXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb250ZXh0LmZhaWwoJ0Vycm9yIGV4ZWN1dGluZyBkYXRhYmFzZSBxdWVyeSB0byBJbnNlcnQgdGhlIGJvb2tpbmcnKTtcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTdHVkZW50ICcgKyBzdHVkZW50ICsgJyBpbnNlcnRlZCBzdWNjZXNzZnVsbHkgJyk7XHJcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnRleHQuZG9uZShudWxsLCAnU3R1ZGVudCByZWNvcmQgaW5zZXJ0ZWQgc3VjY2Vzc2Z1bGx5ICcgKyBzdHVkZW50KTtcdCAgICBcdFx0XHRcdFxyXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCByZXN1bHRzKTtcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHRcdFx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7IC8vIEV4aXN0aW5nIHN0dWRlbnRcclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2VzcyBleGlzdGluZyBzdHVkZW50ICR7c3R1ZGVudElEfWApO1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIG51bGwpO1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgfVxyXG5cdFx0XHQgICAgICAgICAgICB9LCBmdW5jdGlvbiAoY2FsbGJhY2spIHsgLy8gUHJvY2VzcyBtYW55LXRvLW1hbnkgcmVsYXRpb25zaGlwc1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgYXN5bmMuc2VyaWVzKFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoY2FsbGJhY2spIHsgLy8gR2V0IFN0dWRlbnQgSURcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0U3R1ZGVudChzdHVkZW50LCBmdW5jdGlvbiAoZXJyLCByZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcImdldFN0dWRlbnQoKSBmYWlsZWQhIGVycjogXCIgKyBKU09OLnN0cmluZ2lmeShlcnIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHVkZW50SUQgPSByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoY2FsbGJhY2spIHsgLy8gR2V0IGV4aXN0aW5nIHJlbGF0aW9uc2hpcCwgaWYgYW55XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWxhdGlvbnNoaXBfcXVlcnkgPSBgc2VsZWN0IGlkIGZyb20gdGVhY2hlcl9zdHVkZW50IHdoZXJlIHRlYWNoZXJpZCA9ICcke3RlYWNoZXJJRH0nICYmIHN0dWRlbnRpZCA9ICcke3N0dWRlbnRJRH0nYDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGIucXVlcnkocmVsYXRpb25zaGlwX3F1ZXJ5LCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uc2hpcElEID0gcmVzdWx0WzBdLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYEdldCByZWxhdGlvbnNoaXA6ICR7cmVsYXRpb25zaGlwSUR9YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vIHJlbGF0aW9uc2hpcCFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvciwgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxhdGlvbnNoaXBJRCA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBZGQgbmV3IHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHRlYWNoZXIgJHt0ZWFjaGVySUR9IGFuZCBzdHVkZW50ICR7c3R1ZGVudElEfWApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluc2VydCA9IGBJTlNFUlQgSU5UTyB0ZWFjaGVyX3N0dWRlbnQgKHRlYWNoZXJpZCwgc3R1ZGVudGlkKSBWQUxVRVMgKCcke3RlYWNoZXJJRH0nLCAnJHtzdHVkZW50SUR9JylgO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGIucXVlcnkoaW5zZXJ0LCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvci5tZXNzYWdlKTsgLy8gaWYgZXJyb3Igb2NjdXJlZCBkdXJpbmcgY29ubmVjdGlvbiBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb250ZXh0LmZhaWwoJ0Vycm9yIGV4ZWN1dGluZyBkYXRhYmFzZSBxdWVyeSB0byBJbnNlcnQgdGhlIGJvb2tpbmcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTmV3IHJlbGF0aW9uc2hpcCBpbnNlcnRlZCBzdWNjZXNzZnVsbHkgJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29udGV4dC5kb25lKG51bGwsICdTdHVkZW50IHJlY29yZCBpbnNlcnRlZCBzdWNjZXNzZnVsbHkgJyArIHN0dWRlbnQpO1x0ICAgIFx0XHRcdFx0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCByZXN1bHRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKG51bGwsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHRcdFx0ICAgICAgICAgICAgICAgIF0sIGZ1bmN0aW9uIChlcnIsIHJlc3VsdCkge1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgIC8vIGlmIGFueSBvZiB0aGUgZmlsZSBwcm9jZXNzaW5nIHByb2R1Y2VkIGFuIGVycm9yLCBlcnIgd291bGQgZXF1YWwgdGhhdCBlcnJvclxyXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpXHJcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9uZSBvZiB0aGUgaXRlcmF0aW9ucyBwcm9kdWNlZCBhbiBlcnJvci5cclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWxsIHByb2Nlc3Npbmcgd2lsbCBub3cgc3RvcC5cclxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQSBzdHVkZW50IGZhaWxlZCB0byBwcm9jZXNzLiBFcnJvcjogJyArIEpTT04uc3RyaW5naWZ5KGVycikpO1xyXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVyciwgcmVzdWx0KTtcclxuXHRcdFx0ICAgICAgICAgICAgICAgIH0pO1xyXG5cdFx0XHQgICAgICAgICAgICB9XHJcblx0XHRcdCAgICAgICAgXSwgZnVuY3Rpb24gKGVyciwgcmVzdWx0KSB7XHJcblx0XHRcdCAgICAgICAgICAgIC8vIGlmIGFueSBvZiB0aGUgZmlsZSBwcm9jZXNzaW5nIHByb2R1Y2VkIGFuIGVycm9yLCBlcnIgd291bGQgZXF1YWwgdGhhdCBlcnJvclxyXG5cdFx0XHQgICAgICAgICAgICBpZiAoZXJyKVxyXG5cdFx0XHQgICAgICAgICAgICAgICAgLy8gT25lIG9mIHRoZSBpdGVyYXRpb25zIHByb2R1Y2VkIGFuIGVycm9yLlxyXG5cdFx0XHQgICAgICAgICAgICAgICAgLy8gQWxsIHByb2Nlc3Npbmcgd2lsbCBub3cgc3RvcC5cclxuXHRcdFx0ICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Egc3R1ZGVudCBmYWlsZWQgdG8gcHJvY2Vzcy4gRXJyb3I6ICcrSlNPTi5zdHJpbmdpZnkoZXJyKSk7XHJcblx0XHRcdCAgICAgICAgICAgIGNhbGxiYWNrKGVyciwgcmVzdWx0KTtcclxuXHRcdFx0ICAgICAgICB9KTtcclxuXHRcdFx0ICAgIH0sIGZ1bmN0aW9uIChlcnIsIHJlc3VsdCkge1xyXG5cdFx0XHQgICAgICAgIC8vIGlmIGFueSBvZiB0aGUgZmlsZSBwcm9jZXNzaW5nIHByb2R1Y2VkIGFuIGVycm9yLCBlcnIgd291bGQgZXF1YWwgdGhhdCBlcnJvclxyXG5cdFx0XHQgICAgICAgIGlmIChlcnIpXHJcblx0XHRcdCAgICAgICAgICAgIC8vIE9uZSBvZiB0aGUgaXRlcmF0aW9ucyBwcm9kdWNlZCBhbiBlcnJvci5cclxuXHRcdFx0ICAgICAgICAgICAgLy8gQWxsIHByb2Nlc3Npbmcgd2lsbCBub3cgc3RvcC5cclxuXHRcdFx0ICAgICAgICAgICAgY29uc29sZS5lcnJvcignQSBzdHVkZW50IGZhaWxlZCB0byBwcm9jZXNzJyk7XHJcblx0XHRcdCAgICAgICAgZWxzZVxyXG5cdFx0XHQgICAgICAgICAgICBjb25zb2xlLmxvZygnQWxsIHN0dWRlbnRzIGhhdmUgYmVlbiBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcblx0XHRcdCAgICAgICAgY2FsbGJhY2soZXJyLCByZXN1bHQpO1xyXG5cdFx0XHQgICAgfSk7XHJcblx0XHRcdH1cclxuXHRcdF0sIGZ1bmN0aW9uKGVyciwgcmVzdWx0cykge1xyXG4gICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiL2FwaS9yZWdpc3RyYXRpb24gRXJyb3I6IFwiICsgSlNPTi5zdHJpbmdpZnkoZXJyKSk7XHJcbiAgICAgICAgICAgICAgICByZXMuc3RhdHVzKGVyci5zdGF0dXMgfHwgNTAwKTtcclxuICAgICAgICAgICAgICAgIHJlcy5qc29uKHsgJ21lc3NhZ2UnOiBlcnIubWVzc2FnZSB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuXHRcdFx0ICAgIC8vIEluZGV4IG9mIHJlc3VsdHM6XHJcblx0XHRcdFx0Ly8gMDogcmVzdWx0IGZyb20gdGhlIGZpcnN0IHNlcmlhbCBmdW5jdGlvblxyXG4gICAgICAgICAgICAgICAgLy8gMTogcmVzdWx0cyBmcm9tIHRoZSBzZWNvbmQgc2VyaWFsIGZ1bmN0aW9uXHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwicmVnaXN0ZXIgcmVzdWx0OiBcIiArIEpTT04uc3RyaW5naWZ5KHJlc3VsdHMpKTtcclxuICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoMjA0KS5lbmQoKTtcclxuICAgICAgICAgICAgfVxyXG5cdFx0fSk7XHJcbiAgICB9IGVsc2UgeyAvLyBpZiAodGVhY2hlciAhPT0nJyAmJiBzdHVkZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApO1xyXG4gICAgICAgIHJlcy5qc29uKG1lc3NhZ2UpO1xyXG4gICAgfVxyXG59O1xyXG5tb2R1bGUuZXhwb3J0cyA9IFJlZ2lzdHJhdGlvbjsiXX0=